//timeoutMenu.js 0.1a https://github.com/shrue348/ Open source under the MIT License. Copyright © 2016 Aleksander Alekseev All rights reserved.
!function(e){e.fn.timeoutMenu=function(t){var t=e.extend({delay:200},t),n=e(document),i=e("body"),o=e(this),a=o.find("ul"),d=o.find("ul").prev("a"),u=o.find("ul"),s=function(){window.globalMenuTimeout=!1,dragging=!1,a.hide(),d.addClass("test"),i.on("touchmove",function(){dragging=!0}),i.on("",function(){dragging=!1}),n.on("click",l),o.on("mouseleave",l),d.on("mouseenter",r),d.on("touchend focus",p)},l=function(n){0==e(n.target).closest(o).length&&(e(u).hide(),e(d).removeClass("tapped")),"mouseleave"==n.type&&(window.clearTimeout(window.globalMenuTimeout),window.globalMenuTimeout=window.setTimeout(function(){e(u).hide(),e(d).removeClass("tapped")}.bind(this),t.delay))},r=function(){window.clearTimeout(window.globalMenuTimeout),window.globalMenuTimeout=window.setTimeout(function(){e(this).trigger("touchend")}.bind(this),t.delay)},p=function(t){if("touchend"==t.type&&0==dragging||"mouseenter"==t.type)if(e(this).hasClass("tapped")){e(this).attr("href")}else e(this).parent().parent().find(".tapped").next("ul").hide(),e(this).parent().parent().find(".tapped").removeClass("tapped"),e(this).addClass("tapped"),e(this).next("ul").show(),t.stopImmediatePropagation(),t.preventDefault()};return this.each(s)}}(jQuery);