//timeoutMenu.js 0.1a https://github.com/shrue348/ Open source under the MIT License. Copyright © 2016 Aleksander Alekseev All rights reserved.
!function(e){e.fn.timeoutMenu=function(n){var n=e.extend({delay:200},n),o=e(document),t=e("body"),i=e(this),u=i.find("ul"),d=i.find("ul").prev("a"),a=i.find("ul"),l=function(){window.globalMenuTimeout=!1,dragging=!1,u.hide(),t.on("touchmove",function(){dragging=!0,console.log("dragging.true")}),t.on("touchstart",function(){dragging=!1,console.log("dragging.false")}),o.on("click",s),i.on("mouseleave",s),d.on("mouseenter",g),d.on("touchend focus",r),a.on("mouseenter",c)},s=function(o){0==e(o.target).closest(i).length&&(e(a).hide(),e(d).removeClass("tapped")),"mouseleave"==o.type&&(window.clearTimeout(window.globalMenuTimeout),window.globalMenuTimeout=window.setTimeout(function(){e(a).hide(),e(d).removeClass("tapped")}.bind(this),n.delay))},g=function(){window.clearTimeout(window.globalMenuTimeout),window.globalMenuTimeout=window.setTimeout(function(){e(this).trigger("touchend")}.bind(this),n.delay)},r=function(n){if("touchend"==n.type&&0==dragging||"mouseenter"==n.type)if(e(this).hasClass("tapped")){e(this).attr("href")}else i.find(".tapped").next("ul").hide(),i.find(".tapped").removeClass("tapped"),e(this).addClass("tapped"),e(this).next("ul").show(),n.stopImmediatePropagation(),n.preventDefault()},c=function(){window.clearTimeout(window.globalMenuTimeout)};return this.each(l)}}(jQuery);